<!DOCTYPE html>
{% load static %}
{% load jsonify %}
{% load ctxvalue %}

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <title>{{ page_label}}|{{ title }}</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <script src="{{ js_config.js_lib.jquery }}"></script>
    <script src="{{ js_config.js_lib.md5 }}"></script>
    <link rel="stylesheet" href="{{ js_config.js_lib.font_awesome }}">
    <script src="{{ js_config.js_lib.vuejs }}"></script>
    <script src="{{ js_config.js_lib.composition_api }}"></script>

    <!--<script src="{{ js_config.js_lib.vuex }}"></script>-->
    <link rel="stylesheet" href="{{ js_config.js_lib.bootstrap_css }}">
    <script src="{{ js_config.js_lib.bootstrap }}"></script>

    <script src="{{ js_config.js_lib.nice_validator }}"></script>
    <link rel="stylesheet" href="{{ js_config.js_lib.nice_validator_css }}">
    <!--<link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">-->
    <!-- Theme style -->
    <script src="{{ js_config.js_lib.adminlte }}"></script>
    <link rel="stylesheet" href="{{ js_config.js_lib.adminlte_css }}">
    <link rel="stylesheet" href="{{ js_config.js_lib.adminlte_them_css }}">
    <script src="{{ js_config.js_lib.moment }}"></script>

    <script src="{{ js_config.js_lib.exfun }}"></script>
    <script src="{{ js_config.js_lib.director }}"></script>
    <script src="{{ js_config.js_lib.jb_admin }}"></script>

    <script src="{{ js_config.js_lib.element }}"></script>
    <link href="{{ js_config.js_lib.element_css }}" rel="stylesheet">

    <script src="{{ js_config.js_lib.sortablejs }}"></script>


    <!--<link rel="stylesheet" href="https://cdn.bootcss.com/admin-lte/2.4.3/css/AdminLTE.min.css">-->
    <!-- AdminLTE Skins. We have chosen the skin-blue for this starter
          page. However, you can choose any other skin. Make sure you
          apply the skin class to the body tag so the changes take effect. -->
    <!--<link rel="stylesheet" href="https://cdn.bootcss.com/admin-lte/2.4.3/css/skins/skin-blue.min.css">-->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <!--<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>-->
    <!--<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>-->
    <![endif]-->

    <title>Admin</title>
    <!-- Google Font -->
    <!--<link rel="stylesheet"-->
    <!--href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">-->
    <!--<script src="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>-->
    <script src="{{ js_config.js_lib.nprogress }}"></script>
    <link href="{{ js_config.js_lib.nprogress_css }}" rel="stylesheet">
    <!--<link href="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">-->


    {% for lib in extra_js %}
    <script src='{{ lib | ctxvalue:js_config.js_lib }}'></script>
    {% endfor %}

    {% for lib in extra_css %}
    <link href='{{ lib | ctxvalue:js_config.js_lib }}' rel="stylesheet">
    {% endfor %}

    <script>
        (function(){
            document.onreadystatechange = function(){
                NProgress.configure({ showSpinner: false });
                NProgress.start();
                console.log(document.readyState);
                if(document.readyState == "Uninitialized"){
                    NProgress.set(1);
                }
                if(document.readyState == "Interactive"){
                    NProgress.set(0.5);
                }
                if(document.readyState == "complete"){
                    NProgress.done();
                }
            }
        })();

        window.onbeforeunload=function(){
            NProgress.start();
            setInterval(function(){
                NProgress.inc()
            },300)

            if($('body').hasClass('sidebar-collapse')){
                sessionStorage.setItem("sidebar-collapse",true);
            }else{
                sessionStorage.removeItem("sidebar-collapse");
            }
        }

        //        Vue.use(Vuex);
        //        var store = new Vuex.Store({
        //        });
    </script>
    <style>
        .bar{
            background: #dd453b !important;
        }

        .treeview:last-child ul{
            padding-bottom: 60px;
        }

        /*html {*/
        /*min-height: 100%;*/
        /*_height:100%;*/
        /*}*/
        /*body {*/
        /*margin: 0;*/
        /*padding: 0;*/
        /*min-height: 100%;*/
        /*_height:100%;*/
        /*}*/

    </style>
    {% block head-script %}
    {% endblock %}
</head>

{% include 'director/reverse.html' %}

<script>
    if(js_config.is_debug){
        Vue.config.devtools = true
    }else{
        Vue.config.devtools = false
    }
    menu= {{menu| jsonify}}
    menu_search={{ menu_search | jsonify}}
    menu_expand_all = {{ menu_expand_all | jsonify }} || false
    head_bar_data ={{head_bar_data | jsonify}}

    //    js_config = {//{js_config | jsonify}//}


</script>
<style>
.out-wrapper{
    display: flex;
}
.el-menu-vertical-demo:not(.el-menu--collapse) {
    width: 200px;
    min-height: 400px;
}

</style>
<body >

<div id="tab-app" class="out-wrapper">
<div style="width:200px;">
    <el-radio-group v-model="isCollapse" style="margin-bottom: 20px;">
        <el-radio-button :label="false">展开</el-radio-button>
        <el-radio-button :label="true">收起</el-radio-button>
    </el-radio-group>
    <el-menu
            :collapse="isCollapse"
            class="el-menu-vertical-demo"
            @open="handleOpen"
            @close="handleClose"
            background-color="#545c64"
            text-color="#fff"
            active-text-color="#ffd04b">
        <el-submenu index="1">
            <template slot="title">
                <i class="el-icon-location"></i>
                <span>导航一</span>
            </template>
            <el-menu-item-group>
                <template slot="title">分组一</template>
                <el-menu-item index="1-1">选项1</el-menu-item>
                <el-menu-item index="1-2">选项2</el-menu-item>
            </el-menu-item-group>
            <el-menu-item-group title="分组2">
                <el-menu-item index="1-3">选项3</el-menu-item>
            </el-menu-item-group>
            <el-submenu index="1-4">
                <template slot="title">选项4</template>
                <el-menu-item index="1-4-1">选项1</el-menu-item>
            </el-submenu>
        </el-submenu>
        <el-menu-item index="2">
            <i class="el-icon-menu"></i>
            <span slot="title">导航二</span>
        </el-menu-item>
        <el-menu-item index="3" disabled>
            <i class="el-icon-document"></i>
            <span slot="title">导航三</span>
        </el-menu-item>
        <el-menu-item index="4">
            <i class="el-icon-setting"></i>
            <span slot="title">导航四</span>
        </el-menu-item>
    </el-menu>
</div>
    <div class="flex-grow">

        <div style="margin-bottom: 20px;">
            <el-button
                    size="small"
                    @click="addTab(editableTabsValue)"
            >
                add tab
            </el-button>
        </div>
        <el-tabs class="tabs-sort" v-model="editableTabsValue" type="card" closable @tab-remove="removeTab">
            <el-tab-pane
                    v-for="(item, index) in editableTabs"
                    :key="item.name"
                    :label="item.title"
                    :name="item.name"
            >
                {{item.content}}
            </el-tab-pane>
        </el-tabs>


    </div>




</div>
</body>
<script>
    new Vue({
        el:'#tab-app',
        data:{
            isCollapse:false,



            editableTabsValue: '2',
            editableTabs: [{
                title: 'Tab 1',
                name: '1',
                content: 'Tab 1 content'
            }, {
                title: 'Tab 2',
                name: '2',
                content: 'Tab 2 content'
            }],
            tabIndex: 2
        },
        mounted(){
            this.$nextTick(()=>{
                debugger
                let el = this.$el.querySelector('.tabs-sort .el-tabs__nav')
                Sortable.create(el,{
                    onEnd:(evt)=>{
                        const tempIndex = this.editableTabs.splice(evt.oldIndex,1)[0]
                        this.editableTabs.splice(evt.newIndex,0,tempIndex)
                    }
                })
            })

        },
        methods: {
            handleOpen(key, keyPath) {
                console.log(key, keyPath);
            },
            handleClose(key, keyPath) {
                console.log(key, keyPath);
            },


            addTab(targetName) {
                let newTabName = ++this.tabIndex + '';
                this.editableTabs.push({
                    title: 'New Tab',
                    name: newTabName,
                    content: 'New Tab content'
                });
                this.editableTabsValue = newTabName;
            },
            removeTab(targetName) {
                let tabs = this.editableTabs;
                let activeName = this.editableTabsValue;
                if (activeName === targetName) {
                    tabs.forEach((tab, index) => {
                        if (tab.name === targetName) {
                            let nextTab = tabs[index + 1] || tabs[index - 1];
                            if (nextTab) {
                                activeName = nextTab.name;
                            }
                        }
                    });
                }

                this.editableTabsValue = activeName;
                this.editableTabs = tabs.filter(tab => tab.name !== targetName);
            }
        }
    })


</script>
<!--<script src="https://cdn.bootcss.com/admin-lte/2.4.3/js/adminlte.min.js"></script>-->

<!--<script src="/static/lib/layui/layui.js"></script>-->
<!--<script src="/static/lib/layui/lay/modules/layer.js"></script>-->
<!--<script src="https://cdn.bootcss.com/layer/3.1.0/layer.js"></script>-->
<script src="{{ js_config.js_lib.layer }}"></script>

<!--<script src="https://cdn.bootcss.com/layer/3.1.0/layer.js"></script>-->
<!--<script src="https://unpkg.com/vue-easytable/umd/js/index.js"></script>-->
<!--<link rel="stylesheet" href="https://unpkg.com/vue-easytable/umd/css/index.css">-->

<!--<script src="https://unpkg.com/element-ui/lib/index.js"></script>-->

{% if js_config.tr.element_translation_js != "element_translation_js" %}
<script src="{{ js_config.tr.element_translation_js }}"></script>
<script>
    ELEMENT.locale(ELEMENT.lang.en)
    <!--if(js_config.tr.element_translation_js!=''){-->
    <!--ex.eval(js_config.tr.element_translation_js)-->
    <!--}-->
</script>
{% endif %}

<script>
    init_express={{ init_express | jsonify }}
    if(init_express){
        ex.eval(init_express)
    }
</script>

<style>
    .right-sidebar-mask{
        display: none;
    }
    .control-sidebar-open .right-sidebar-mask{
        display: block;
    }

</style>
</html>