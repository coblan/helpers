<script>
    //ln_state={}

    department_url = "{% url 'organize.department' %}"

    function get_department(root,callback){
        var root=root || {pk:null,name:'公司'}
        ln.pushState({crt_view:'department_win'})
        depart_win.$refs.catalog.dir_data(root)
        depart_win.depart_callback=callback
    }
    $(function(){
        depart_win=new Vue({
            el:'#depart_win',
            data:{
                ln_state:ln_state,
                department_url:department_url,
            },
            methods:{
                on_dirclick:function(department){
                    this.depart_callback(department)
                    history.back()
                },
                get_department:function(root,callback){
                    var root=root || {pk:null,name:'公司'}
                    ln.pushState({crt_view:'department_win'})
                    this.$refs.catalog.dir_data(root)
                    this.depart_callback=callback
                }
            }
        })
    })
</script>

<div id="depart_win">
    <transition name="slide" >
        <div v-show="ln_state.crt_view=='department_win'" class="slide-win">
            <title-bar :with_back="true" title="编辑工作类型"></title-bar>
            <div class="department-win">
                <com-catalog ref="catalog" :url="department_url" :root="{pk:null,name:'公司'}" @dirclick="on_dirclick($event)"
                             :editable="false" inline-template>

                    <div class="com-catalog">
                        <div class="flex">
                            <ol class="breadcrumb flex-grow">
                                <li ><a href="javacript:;" @click="dir_data(root)" v-text="root.name">root</a></li>
                                <li v-for="dir in parents" ><a href="javacript:;" v-text="dir.name" @click="dir_data(dir)" ></a></li>
                            </ol>
                            <slot name="head_end"></slot>
                        </div>

                        <div class="bd">
                            <ul>
                                <li v-for="dir in dirs" class="dir">

                                    <span v-text="dir.name" class="clickable name" @click="dir_data(dir)"></span>
                                    <button class="btn btn-default btn-xs" type="button" @click="$emit('dirclick',dir)">选择</button>
                                </li>
                            </ul>
                        </div>
                    </div>

                </com-catalog>
            </div>

        </div>
    </transition>
</div>

